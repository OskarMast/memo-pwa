<!DOCTYPE html>
<html>

<head>
<meta name="theme-color" content="white"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Memo Lock">
<meta charset="utf-8" />
<link rel="manifest" href="manifest.json">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <script src="js/prebid-ads.js"></script>
  <script src="js/jquery-3.6.0.min.js"></script>
  <script src="js/javascript.js"></script>
  <script src="js/notification-popup.js"></script>
  <script src="js/ofeatures-js.js"></script>
  <link rel="stylesheet" href="css/main.css">
</head>

<body>

  <section class="scrollable-section">
    <div class="my-container">
      <div class=navbar>
        <div class="ofeature-upper-navigation">
          <div class="left-up-nav">
            <img class="app-logo" src="img/index-logo.svg">
          </div>
	        <div class="right-up-nav">
	          <a class="nav-dev-name" href="deviceinfo.html">Device Name</a>
	          <p>|</p>
	          <button class="nav-user-btn"> S </button>
	        </div>
      	</div>

      <div class="scrollmenu">
        <a id="keyManagementId" class="tablinks" href="index.html">Key Management <img class="option-icon" src="img/keymng-icon.svg"></a>
        <a id="openingFeaturesId" href="openingfeat.html" class="active">Opening Features <img class="option-icon" src="img/openfeat-icon-colour.svg"></a>
        <a class="tablinks" href="advancedsettings.html">Advanced Settings <img class="option-icon" src="img/advset-icon.svg"></a>
			 	<a id="audittrailID" href="audittrail.html" class="tablinks">Audit Trail <img class="option-icon" src="img/auditlist-icon.svg"></a>
         <a id="uploadFirmwareId" href="updatedev.html" class="tablinks">Update device <img class="option-icon" src="img/update-icon.svg"></a>
      </div>
      </div>
    </div>

    <div id="notif">
      <div class="notif-text">
        <p class="notif-title">Changes Saved Successfully!</p>
        <div class="alignTypeSn">
          <p id="notifText" class="body-16-regular">Enabled</p>
        </div>

      </div>
      <div class="notif-image">
        <img src="img/check.svg">
      </div>
    </div>

    <section class="ofeatures-cards-management">

      <div class="keylist-header" id="dropdown-openingfeatures">
        <div class="left-header">
          <p class="opening-Features-Title" id="opening-Modes">Opening Modes </p>
        </div>
        <div class="right-header">
          <div class="dropdown-menu">
            <button class="select-btn" id="btn-import">Export</button>
            <button class="select-btn" id="btn-export">Import</button>
          </div>
        </div>
      </div>

      <!-- ---------- Security Mode ---------- -->
      <a href="securitymode.html">
        <div class="card">
          <div class="card-image">
            <img id="cardImage" src="img/opening-security-mode.svg" alt="activated card list">
          </div>
          <div>
            <p class="card-title" id="cTitle">Security Mode</p>
            <p class="card-body-text">Presenting a key unlocks for a preselected time, it locks IMMEDIATELY when opening the door.</p>
          </div>

          <div class="option-toggle-security">
            <div class="switch-toggle"> <!-- Setting for any door open warning alarm ON/OFF -->
              <input name="CF_OUT_CUT"  type="checkbox" id="myCheckboxSecurity" onchange="saveSetting('CF_OUT_CUT', String(Number(document.getElementById('myCheckboxSecurity').checked)), 'LOCAL')" checked>
              <label for="myCheckboxSecurity"></label>
            </div>

            <div class="security-toggle-time">
              <div id="oBottomHide" class="number">
                <span id="oContentId" class="minus" name="CF_OUT_DUR_BASE">-</span>
                <div class="input-container">
                <p class="label-sec">Sec.</p>
                  <input id="inputDuration" class="input-with-borders" name="CF_OUT_DUR_BASE" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" onkeypress="return /[0-9a-zA-Z]/i.test(event.key)" onchange="validateSettingValue('inputDuration')" type="number" maxlength="3">
                  </div>
                <span class="plus" name="CF_OUT_DUR_BASE">+</span>
                </div>
            </div>
          </div>
        </div>
      </a>

      <!-- ---------- Watchmaker Mode ---------- -->
      <a href="watchmakermode.html">
        <div class="card">
          <div class="card-image">
            <img id="cardImage" src="img/opening-basic-mode.svg" alt="activated card list">
          </div>
          <div>
            <p class="card-title">Watchmaker Mode</p>
            <p class="card-body-text">Presenting a key unlocks door and stays open, next presentation will close and stays closed.</p>
          </div>
          <div class="option-toggle-watchmaker">
            <div class="switch-toggle"> <!-- Setting for any door open warning alarm ON/OFF -->
              <input name="CF_OUT_FLF_BASE"  type="checkbox" id="myCheckboxWatchmaker" onchange="saveSetting('CF_OUT_FLF_BASE', String(Number(document.getElementById('myCheckboxWatchmaker').checked)))" checked>
              <label for="myCheckboxWatchmaker"></label>
            </div>
          </div>
        </div>
      </a>

      <!-- ---------- Validation Mode ---------- -->
      <a href="validationmode.html">
        <div class="card">
          <div class="card-image">
            <img id="cardImage" src="img/validation-mode.svg" alt="activated card list">
          </div>
          <div>
            <p class="card-title">Validation Mode</p>
            <p class="card-body-text">Keys remain active for typically one work-shift, then keys become inactive and require validation for next shift</p>
          </div>
          <div class="option-toggle-validation">
            <div class="switch-toggle"> <!-- Setting for any door open warning alarm ON/OFF -->
              <input name="CF_MSC3_ALIT" type="checkbox" id="myCheckboxValidation" onchange="saveSetting('CF_MSC3_ALIT', String(Number(document.getElementById('myCheckboxValidation').checked)))" checked>
              <label for="myCheckboxValidation"></label>
            </div>

            <div class="validation-toggle-time">
              <div class="group-input-fields"  style="background: none;">
                <div class="input-container">
                  <input id="validationDays" class="input-with-borders" name="CF_TIMED_ACCESS" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                    onkeypress="return /[0-9a-zA-Z]/i.test(event.key)" onchange="validateSettingValue('validationHours')" type="number" maxlength="2" min="0" max="10" value="0">
                  <p class="label-sec">days</p>
                </div>
                <div class="input-container">
                  <input id="validationHours" class="input-with-borders" name="CF_TIMED_ACCESS" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                    onkeypress="return /[0-9a-zA-Z]/i.test(event.key)" onchange="validateSettingValue('validationHours')" type="number" maxlength="3">
                  <p class="label-sec">hours</p>
                </div>
              </div>
            </div>
          </div>
          </div>
        </div>
      </a>

      <div class="opening-Features-Security">
        <p class="opening-Features-Title">Security Features</p>
      </div>

      <!-- ---------- Open Door Warning ---------- -->
      <a href="opendoorwarning.html">
        <div class="card">
          <div class="card-image">
            <img id="cardImage" src="img/open-door-warning.svg" alt="activated card list">
          </div>
          <div>
            <p class="card-title">Open Door Warning</p>
            <p class="card-body-text">Should the door stay open longer than predetermined time (20s) a warning sound reminds to close </p>
          </div>

          <div class="option-toggle-odwarning">
            <div class="switch-toggle"> <!-- Setting for any door open warning alarm ON/OFF -->
              <input name="CF_MSC3_ALDO"  type="checkbox" id="myCheckboxDoorWarning" onchange="saveSetting('CF_MSC3_ALDO', String(Number(document.getElementById('myCheckboxDoorWarning').checked)))" checked>
              <label for="myCheckboxDoorWarning"></label>
            </div>

            <div class="doorwarning-toggle-time">
              <div id="oBottomHide"  class="number">
                <span id="oContentId" class="minus" name="CF_AL_DOOPN_G1">-</span>
                <div class="input-container">
                <p class="label-sec">Sec.</p>
                  <input id="inputDurationDWarning" class="input-with-borders" name="CF_AL_DOOPN_G1" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" onkeypress="return /[0-9a-zA-Z]/i.test(event.key)" onchange="validateSettingValue('inputDurationDWarning')" type="number" maxlength="3"
                    value="30">  <!--maxlength="getSettingMaxLen(document.getElementById('inputDuration').name)"  min="getSettingMin(document.getElementById('inputDuration').name)" max="getSettingMax(document.getElementById('inputDuration').name)" onchange="saveSetting(document.getElementById('inputDuration').name, document.getElementById('inputDuration').value)  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" -->
                  </div>
                <span class="plus" name="CF_AL_DOOPN_G1">+</span>
              </div>
            </div>
          </div>
        </div>
      </a>

      <!-- ---------- Intrusion Alarm ---------- -->
      <a href="intrusionalarm.html">
        <div class="card">
          <div class="card-image">
            <img id="cardImage" src="img/intrusion-alarm.svg" alt="activated card list">
          </div>
          <div>
            <p class="card-title">Intrusion Alarm Sound</p>
            <p class="card-body-text">In the moment a door is opened without a legitimate chip key, an alarm will sound out of that display.</p>
          </div>
          <div class="option-toggle-intalarm">
            <div class="switch-toggle"> <!-- Setting for any door open warning alarm ON/OFF -->
              <input name="CF_MSC3_ALIT"  type="checkbox" id="myCheckboxIntAlarm" onchange="saveSetting('CF_MSC3_ALIT', String(Number(document.getElementById('myCheckboxIntAlarm').checked)))" checked>
              <label for="myCheckboxIntAlarm"></label>
            </div>
          </div>
        </div>
      </a>

      <!-- ---------- 2-Way Authentication ---------- -->
      <a href="2wayauthentication.html">
        <div class="card">
          <div class="card-image">
            <img id="cardImage" src="img/2way-authentication.svg" alt="activated card list">
          </div>
          <div>
            <p class="card-title">2-Way Authentication</p>
            <p class="card-body-text">2 authorized keys must be presented within 5s to activate a lock and open a door - this protects special valuable items</p>
          </div>
          <div class="option-toggle-2way">
            <div class="switch-toggle"> <!-- Setting for any door open warning alarm ON/OFF -->
              <input name="CF_OUT_SEC_BASE" type="checkbox" id="myCheckbox2Way" onchange="saveSetting('CF_OUT_SEC_BASE', String(Number(document.getElementById('myCheckbox2Way').checked)), '2-WAY-AUTHORIZATION')" checked>
              <label for="myCheckbox2Way"></label>
            </div>
          </div>
        </div>
      </a>

      <!-- ---------- Opening Delay ---------- -->
      <a href="openingdelay.html">
        <div class="card">
          <div class="card-image">
            <img id="cardImage" src="img/opening-delay.svg" alt="activated card list">
          </div>
          <div>
            <p class="card-title">Opening Delay</p>
            <p class="card-body-text">A predefined time passes after a key is presented before the lock is activated - that protects high values better.</p>
          </div>
          <div class="option-toggle-odelay">
            <div class="opendelay-toggle-time">
              <div id="oBottomHide"  class="number">
                <span id="oContentId" class="minus" name="CF_OUT_DEL_BASE">-</span>
                <div class="input-container">
                  <p class="label-sec">Sec.</p>
                  <input id="inputDurationOpenDelay" class="input-with-borders" name="CF_OUT_DEL_BASE" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" onkeypress="return /[0-9a-zA-Z]/i.test(event.key)" onchange="validateSettingValue('inputDurationOpenDelay')" type="number" maxlength="3"
                    value="30">  <!--maxlength="getSettingMaxLen(document.getElementById('inputDuration').name)"  min="getSettingMin(document.getElementById('inputDuration').name)" max="getSettingMax(document.getElementById('inputDuration').name)" onchange="saveSetting(document.getElementById('inputDuration').name, document.getElementById('inputDuration').value)  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" -->
                  </div>
                <span class="plus" name="CF_OUT_DEL_BASE">+</span>
              </div>
            </div>
          </div>
        </div>
      </a>

    </section>

      <!-- Notification Pop-up -->
    <div id="notification-popup">
      <h1 class="notif-header">Connection Lost</h1>
      <div class="closebtn" onclick="hideNotification()"><h2 class="closebtn">X</h2></div>
      <p>You have been disconnected from the device.</p>
      <div class="wifi-icon-container">
        <img src="img/disconnect-icon.svg" class="wifi-icon">
      </div>
    </div>

  </section>
  <script>
    if( window.canRunAds === undefined ){
      // adblocker detected, show fallback
      console.log("Adblocker detected");
    }
    else console.log("Adblocker not detected");
	</script>
	<script src="js/main.js"></script>
</body>
</html>

<script>
  //Security
  fetchSetting('myCheckboxSecurity', 'CF_OUT_CUT', 'LOCAL');
  fetchSetting('inputDuration' , 'CF_OUT_DUR_BASE');

  //Watchmaker
  fetchSetting('myCheckboxWatchmaker', 'CF_OUT_FLF_BASE');

  //Validation
  fetchSetting('validationHours', 'CF_TIMED_ACCESS');

  //Open Door Warning
  fetchSetting('myCheckboxDoorWarning', 'CF_MSC3_ALDO'); //String(parseInt(objJsonMemoryKeyValues.CF_MSC3_ALDO[0].Address)), String(parseInt(objJsonMemoryKeyValues.CF_MSC3_ALDO[0].BitPos)), 'toggleswitch');
  fetchSetting('inputDurationDWarning' , 'CF_AL_DOOPN_G1');//String(parseInt(objJsonMemoryKeyValues.CF_AL_DOOPN_G1[0].Address)), String(parseInt(objJsonMemoryKeyValues.CF_AL_DOOPN_G1[0].BitPos)), 'inputfieldDuration');

  //Intrusion Alarm
  fetchSetting('myCheckboxIntAlarm', 'CF_MSC3_ALIT');

  //2-Way
  fetchSetting('myCheckbox2Way', 'CF_OUT_SEC_BASE', '2-WAY-AUTHORIZATION');

  //Opening Delay
  fetchSetting('inputDurationOpenDelay' , 'CF_OUT_DEL_BASE');
</script>
